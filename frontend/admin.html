<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô</title>

    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- CSS ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='admin.css') }}"
    />
  </head>
  <body>
    <!-- ‡πÅ‡∏™‡∏î‡∏á Flash Message (‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå) -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="container mt-3">
          {% for category, message in messages %}
            <div class="alert alert-{{ 'success' if category == 'success' else 'danger' }} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- ==============================
         üîò Floating Button Group (‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô)
         ============================== -->
    <div class="floating-btn-group">
      <!-- 1. ‡∏õ‡∏∏‡πà‡∏° Walk-in (‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á) -->
      <button
        type="button"
        class="btn btn-warning shadow fw-bold me-2"
        data-bs-toggle="modal"
        data-bs-target="#qrModal"
      >
        üì≤ QR ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô
      </button>

      <!-- 2. ‡∏õ‡∏∏‡πà‡∏° Reservation (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß) -->
      <button
        type="button"
        class="btn btn-success shadow fw-bold me-2"
        data-bs-toggle="modal"
        data-bs-target="#qrBookingModal"
      >
        üìÖ QR ‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞
      </button>

      <!-- 3. ‡∏õ‡∏∏‡πà‡∏° Dashboard (‡∏™‡∏µ‡∏ü‡πâ‡∏≤) -->
      <a href="/dashboard" class="btn btn-info text-white shadow fw-bold">
        üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î
      </a>
    </div>

    <!-- ==============================
         üñºÔ∏è Modal 1: QR Code Walk-in
         ============================== -->
    <div class="modal fade" id="qrModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-warning">
            <h5 class="modal-title fw-bold">
              üì≤ QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Walk-in)
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body text-center p-4">
            <p class="mb-3">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</p>
            <div id="qrcode" class="d-flex justify-content-center mb-3"></div>
            <h5 class="text-primary fw-bold" id="linkText">Loading...</h5>
            <small class="text-muted"
              >‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏õ‡∏∞‡πÑ‡∏ß‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</small
            >
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              ‡∏õ‡∏¥‡∏î
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ==============================
         üñºÔ∏è Modal 2: QR Code Booking
         ============================== -->
    <div class="modal fade" id="qrBookingModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-success text-white">
            <h5 class="modal-title fw-bold">üìÖ QR Code ‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body text-center p-4">
            <p class="mb-3">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞</p>
            <div
              id="qrcodeBooking"
              class="d-flex justify-content-center mb-3"
            ></div>
            <h5 class="text-success fw-bold" id="linkTextBooking">
              Loading...
            </h5>
            <small class="text-muted"
              >‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</small
            >
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              ‡∏õ‡∏¥‡∏î
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ==============================
         üè† ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å (Main Container)
         ============================== -->
    <div class="container mt-5 mb-5">
      <h1 class="mb-4 text-center fw-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô</h1>

      <!-- 1. ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏∏‡∏ü‡πÄ‡∏ü‡∏ï‡πå -->
      <div
        class="bg-white p-3 rounded shadow-sm mb-4 border-start border-5 border-primary"
      >
        <div class="row align-items-center">
          <div class="col-md-8">
            <h5 class="mb-0 text-primary fw-bold">‚è∞ ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏∏‡∏ü‡πÄ‡∏ü‡∏ï‡πå (‡∏ô‡∏≤‡∏ó‡∏µ)</h5>
            <small class="text-muted"
              >‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Start ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏ö</small
            >
          </div>
          <div class="col-md-4">
            <div class="input-group">
              <span class="input-group-text bg-primary text-white"
                >‚è±Ô∏è ‡∏ô‡∏≤‡∏ó‡∏µ</span
              >
              <input
                type="number"
                id="globalDuration"
                class="form-control text-center fw-bold fs-5"
                value="90"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- 2. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Waiting List & Reservation -->
      <div class="card shadow-sm mb-5">
        <div class="card-header bg-white pt-3 pb-0">
          <ul
            class="nav nav-tabs card-header-tabs"
            id="queueTabs"
            role="tablist"
          >
            <!-- Tab 1: Walk-in -->
            <li class="nav-item" role="presentation">
              <button
                class="nav-link active fw-bold text-primary"
                id="walkin-tab"
                data-bs-toggle="tab"
                data-bs-target="#walkin-pane"
                type="button"
                role="tab"
              >
                üö∂ ‡∏Ñ‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô ({{ waiting_list|length }})
              </button>
            </li>
            <!-- Tab 2: Reservations -->
            <li class="nav-item" role="presentation">
              <button
                class="nav-link fw-bold text-success"
                id="reservation-tab"
                data-bs-toggle="tab"
                data-bs-target="#reservation-pane"
                type="button"
                role="tab"
              >
                üìÖ ‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ({{ reservations|length }})
              </button>
            </li>
          </ul>
        </div>

        <div class="card-body">
          <div class="tab-content" id="queueTabsContent">
            <!-- TAB PANE 1: WALK-IN -->
            <div
              class="tab-pane fade show active"
              id="walkin-pane"
              role="tabpanel"
            >
              {% if waiting_list %}
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0 text-center">
                  <thead class="table-light">
                    <tr>
                      <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                      <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç</th>
                      <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                      <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≠‡∏á</th>
                      <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for q in waiting_list %}
                    <tr>
                      <td class="text-muted">{{ loop.index }}</td>
                      <td>
                        <span
                          class="badge rounded-pill fs-5 {{ 'bg-primary' if q.queue_type == 'A' else 'bg-warning text-dark' }}"
                        >
                          {{ q.queue_type }}-{{ '%03d' % q.id }}
                        </span>
                      </td>
                      <td class="fw-bold">{{ q.pax }} ‡∏ó‡πà‡∏≤‡∏ô</td>
                      <td>
                        <small class="text-muted"
                          >{{ q.created_at[11:16] }} ‡∏ô.</small
                        >
                      </td>
                      <td>
                        <div class="d-flex justify-content-center gap-2">
                            <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß (LINE) -->
                            {% if q.line_user_id %}
                            <form action="/admin/notify/{{ q.id }}" method="POST">
                                <button type="submit" class="btn btn-warning btn-sm rounded-pill px-3" title="‡∏™‡πà‡∏á‡πÑ‡∏•‡∏ô‡πå‡∏ï‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
                                    üîî ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å
                                </button>
                            </form>
                            {% else %}
                            <button class="btn btn-secondary btn-sm rounded-pill px-3" disabled title="‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ LINE">
                                üîî
                            </button>
                            {% endif %}

                            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏¥‡∏ß -->
                            <form
                            action="/cancel-queue/{{ q.id }}"
                            method="POST"
                            onsubmit="return confirm('‚ö†Ô∏è ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?');"
                            >
                            <button
                                type="submit"
                                class="btn btn-outline-danger btn-sm rounded-pill px-3"
                            >
                                ‚ùå
                            </button>
                            </form>
                        </div>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
              {% else %}
              <div class="p-4 text-center text-muted">
                <h4>üéâ ‡∏Ñ‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡∏ß‡πà‡∏≤‡∏á</h4>
                <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Walk-in ‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
              </div>
              {% endif %}
            </div>

            <!-- TAB PANE 2: RESERVATIONS -->
            <div class="tab-pane fade" id="reservation-pane" role="tabpanel">
              {% if reservations %}
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0 text-center">
                  <thead class="table-light">
                    <tr>
                      <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                      <th>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                      <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
                      <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                      <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                      <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for r in reservations %}
                    <tr
                      class="{{ 'table-success' if r.status == 'confirmed' }}"
                    >
                      <td class="fw-bold text-primary fs-5">
                        {{ r.booking_time[0:5] }} ‡∏ô.
                      </td>
                      <td class="text-start">{{ r.customer_name }}</td>
                      <td>{{ r.phone }}</td>
                      <td class="fw-bold">{{ r.num }} ‡∏ó‡πà‡∏≤‡∏ô</td>
                      <td>
                        {% if r.status == 'pending' %}
                        <span class="badge bg-secondary">‡∏£‡∏≠‡∏°‡∏≤‡∏ñ‡∏∂‡∏á</span>
                        {% elif r.status == 'confirmed' %}
                        <span class="badge bg-success">‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß</span>
                        {% else %}
                        <span class="badge bg-dark">{{ r.status }}</span>
                        {% endif %}
                      </td>
                      <td>
                        <div class="d-flex justify-content-center gap-2">
                          <form
                            action="/cancel-reservation/{{ r.id }}"
                            method="POST"
                            onsubmit="return confirm('‚ö†Ô∏è ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì {{ r.customer_name }} ?');"
                          >
                            <button
                              type="submit"
                              class="btn btn-outline-danger btn-sm rounded-pill px-2"
                              title="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á"
                            >
                              ‚úï
                            </button>
                          </form>
                        </div>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
              {% else %}
              <div class="p-4 text-center text-muted">
                <h4>üìÖ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h4>
                <p>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Walk-in ‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà</p>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>

      <!-- 3. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏´‡∏°‡πà -->
      <div class="card shadow-sm mb-5">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏´‡∏°‡πà</h5>
        </div>
        <div class="card-body">
          <form action="/add-table" method="POST">
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ï‡πä‡∏∞</label>
                <input
                  type="text"
                  name="table_name"
                  class="form-control"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô A-01"
                  required
                />
              </div>
              <div class="col-md-4">
                <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                <input
                  type="number"
                  name="capacity"
                  class="form-control"
                  placeholder="4"
                  required
                />
              </div>
              <div class="col-md-4">
                <label class="form-label">‡πÇ‡∏ã‡∏ô</label>
                <select name="zone_type" class="form-select">
                  <option value="walk_in">‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô (Walk-in)</option>
                  <option value="reservation">‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Reservation)</option>
                </select>
              </div>
            </div>
            <button type="submit" class="btn btn-primary w-100 mt-3">
              ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </button>
          </form>
        </div>
      </div>

      <hr />

      <!-- =============================================
           4. ‡∏ú‡∏±‡∏á‡πÇ‡∏ï‡πä‡∏∞ Dashboard
           ============================================= -->

      <!-- ZONE 1: WALK-IN TABLES -->
      <div class="d-flex align-items-center mb-3 mt-4">
        <h3 class="text-primary fw-bold me-2">üö∂ ‡πÇ‡∏ï‡πä‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô (Walk-in) (‡πÇ‡∏ï‡πä‡∏∞ A = ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 4 ‡∏ó‡πà‡∏≤‡∏ô) (‡πÇ‡∏ï‡πä‡∏∞ B = 5 ‡∏ó‡πà‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ)</h3>
        <span class="badge bg-primary rounded-pill"
          >{{ walkin_tables|length }} ‡πÇ‡∏ï‡πä‡∏∞</span
        >
      </div>

      <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-3 mb-5">
        {% for table in walkin_tables %}
        <div class="col">
          <div
            class="card h-100 text-center shadow-sm table-card {{ 'status-busy' if table.status == 'busy' else 'status-empty' }}"
          >
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö‡πÇ‡∏ï‡πä‡∏∞ -->
            <form
              action="/delete-table/{{ table.id }}"
              method="POST"
              class="js-delete-form"
              onsubmit="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡πÇ‡∏ï‡πä‡∏∞ {{ table.table_name }}?');"
            >
              <button
                type="submit"
                class="btn btn-sm border-0 btn-delete-custom"
                title="‡∏•‡∏ö‡πÇ‡∏ï‡πä‡∏∞‡∏ô‡∏µ‡πâ"
              >
                ‚úï
              </button>
            </form>

            <div class="card-body">
              <div class="table-icon">
                {% if table.status == 'busy' %} üç≤ {% else %} ü™ë {% endif %}
              </div>

              <h4 class="card-title fw-bold">{{ table.table_name }}</h4>
              <p class="card-text small mb-2">{{ table.capacity }} ‡∏ó‡πà‡∏≤‡∏ô</p>

              {% if table.status == 'busy' %}
              <div
                class="alert alert-danger p-1 mb-2"
                style="font-size: 0.85rem"
              >
                ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤:
                <strong
                  >{{ table.final_time[11:16] if table.final_time else '??:??'
                  }}</strong
                >
                ‡∏ô.
              </div>
              {% endif %}

              <!-- ‡∏õ‡∏∏‡πà‡∏° Action Walk-in -->
              {% if table.status == 'empty' %}
              <form
                action="/start-table/{{ table.id }}"
                method="POST"
                class="js-start-form"
              >
                <input type="hidden" name="duration" value="" />
                <button class="btn btn-sm btn-success w-100">
                  ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß (Start)
                </button>
              </form>
              {% else %}
              <form
                action="/clear-table/{{ table.id }}"
                method="POST"
                class="js-clear-form"
              >
                <button class="btn btn-sm btn-danger w-100">
                  ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ö‡∏¥‡∏• (Clear)
                </button>
              </form>
              {% endif %}
            </div>
          </div>
        </div>
        {% else %}
        <div class="col-12">
          <div class="alert alert-light text-center border">
            üì≠ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏ï‡πä‡∏∞‡πÇ‡∏ã‡∏ô Walk-in
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏±‡πâ‡∏ô -->
      <hr class="border-3 border-secondary opacity-25 my-5" />

      <!-- ZONE 2: RESERVATION TABLES -->
      <div class="d-flex align-items-center mb-3">
        <h3 class="text-warning text-dark fw-bold me-2">
          üìÖ ‡πÇ‡∏ï‡πä‡∏∞‡∏à‡∏≠‡∏á (Reservation)
        </h3>
        <span class="badge bg-warning text-dark rounded-pill"
          >{{ reservation_tables|length }} ‡πÇ‡∏ï‡πä‡∏∞</span
        >
      </div>

      <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-3 mb-5">
        {% for table in reservation_tables %}
        <div class="col">
          <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏ã‡∏ô‡∏à‡∏≠‡∏á ‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö‡∏™‡πâ‡∏° -->
          <div
            class="card h-100 text-center shadow-sm table-card {{ 'status-busy' if table.status == 'busy' else 'status-empty' }}"
            style="border-top: 5px solid #ffc107"
          >
            <form
              action="/delete-table/{{ table.id }}"
              method="POST"
              class="js-delete-form"
              onsubmit="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡πÇ‡∏ï‡πä‡∏∞ {{ table.table_name }}?');"
            >
              <button
                type="submit"
                class="btn btn-sm border-0 btn-delete-custom"
                title="‡∏•‡∏ö‡πÇ‡∏ï‡πä‡∏∞‡∏ô‡∏µ‡πâ"
              >
                ‚úï
              </button>
            </form>

            <div class="card-body">
              <div class="table-icon">
                {% if table.status == 'busy' %} üç≤ {% else %} üé´ {% endif %}
              </div>

              <h4 class="card-title fw-bold">{{ table.table_name }}</h4>
              <p class="card-text small mb-2">{{ table.capacity }} ‡∏ó‡πà‡∏≤‡∏ô</p>

              {% if table.status == 'busy' %}
              <div
                class="alert alert-danger p-1 mb-2"
                style="font-size: 0.85rem"
              >
                ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤:
                <strong
                  >{{ table.final_time[11:16] if table.final_time else '??:??'
                  }}</strong
                >
                ‡∏ô.
              </div>
              {% endif %}

              <!-- ‡∏õ‡∏∏‡πà‡∏° Action Reservation -->
              {% if table.status == 'empty' %}
              <form
                action="/start-table/{{ table.id }}"
                method="POST"
                class="js-start-form"
              >
                <input type="hidden" name="duration" value="" />
                <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á + ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á -->
                <button class="btn btn-sm btn-warning fw-bold w-100">
                  ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≤‡∏ô (Start)
                </button>
              </form>
              {% else %}
              <form
                action="/clear-table/{{ table.id }}"
                method="POST"
                class="js-clear-form"
              >
                <button class="btn btn-sm btn-danger w-100">
                  ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ö‡∏¥‡∏• (Clear)
                </button>
              </form>
              {% endif %}
            </div>
          </div>
        </div>
        {% else %}
        <div class="col-12">
          <div class="alert alert-light text-center border">
            üì≠ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏ï‡πä‡∏∞‡πÇ‡∏ã‡∏ô‡∏à‡∏≠‡∏á
          </div>
        </div>
        {% endfor %}
      </div>

      <div class="mt-5 text-center">
        <a href="/" class="text-decoration-none text-secondary"
          >‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a
        >
      </div>
    </div>
    <hr class="my-5" />

    <div class="card bg-danger text-white mb-5">
      <div class="card-body d-flex justify-content-between align-items-center">
        <div>
          <h5 class="fw-bold">‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î‡∏ß‡∏±‡∏ô (Close Day)</h5>
          <p class="mb-0 small">
            ‡∏Å‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏¥‡∏ß‡πÄ‡∏õ‡πá‡∏ô 001
            ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ
          </p>
        </div>
        <form
          action="/close-day"
          method="POST"
          onsubmit="return confirm('‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î‡∏ß‡∏±‡∏ô?\n\n- ‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥\n- ‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏¥‡∏ß‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö 1 ‡πÉ‡∏´‡∏°‡πà\n\n‡∏ó‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!');"
        >
          <button type="submit" class="btn btn-light text-danger fw-bold">
            üõë ‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î / ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏¥‡∏ß
          </button>
        </form>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå JS ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ -->
    <script src="{{ url_for('static', filename='admin.js') }}"></script>
  </body>
</html>